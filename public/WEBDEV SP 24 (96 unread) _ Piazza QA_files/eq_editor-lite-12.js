function $$(a){return document.getElementById(a)}function $onchange(d,c){var b=$$(d);if(b){b.onchange=c}}function $onclick(d,c){var b=$$(d);if(b){b.onclick=c}}function setadvert(){var b=$$("latex_formula");var a=b.offsetLeft;b=b.offsetParent;while(b!=null){a=parseInt(a)+parseInt(b.offsetLeft);b=b.offsetParent}$$("advert").style.display=(a<140?"none":"none")}var Cookie={set:function(b,c,a){var d=new Date();d.setDate(d.getDate()+a);document.cookie=b+"="+escape(c)+((a==null)?"":";expires="+d.toGMTString())},get:function(a){if(document.cookie.length>0){c_start=document.cookie.indexOf(a+"=");if(c_start!=-1){c_start=c_start+a.length+1;c_end=document.cookie.indexOf(";",c_start);if(c_end==-1){c_end=document.cookie.length}return unescape(document.cookie.substring(c_start,c_end))}}return""}};URL.get=function(a,b){if(location.href.match(a+"=")){return location.href.split(a+"=")[1].split("&")[0]}return b};var Opacity={set:function(c,a){var b=$$(c).style;b.opacity=(a/100);b.MozOpacity=(a/100);b.KhtmlOpacity=(a/100);b.filter="alpha(opacity="+a+")"},fade:function(d,c,a,b){speed=Math.round(b/100);sgn=(c>a)?-1:1;count=sgn*(a-c);for(i=1;i<count;i++){setTimeout("Opacity.set('"+d+"',"+(i*sgn+c)+")",(i*speed))}},fadeout:function(a){if($$(a)){this.fade(a,100,10,800);setTimeout("$$('"+a+"').style.display='none'",800)}},fadein:function(a){if($$(a)){this.set(a,20);$$(a).style.display="none";this.fade(a,20,100,800)}}};var Panel={plock:null,ctimer:null,otimer:null,oid:null,timer:Array(),open:function(b){if(b){var c=b.id;if(this.timer[c]!=""){clearTimeout(this.timer[c]);this.timer[c]=""}this.timer[c]=setTimeout("$$('"+c+"').style.overflow='visible';",200)}},close:function(b){if(b){var c=b.id;if(this.timer[c]!=""){clearTimeout(this.timer[c]);this.timer[c]=""}this.timer[c]=setTimeout("$$('"+c+"').style.overflow='hidden';",200)}},hoverdiv:null,hlock:false,hover:function(a,b){if(this.hoverdiv){this.lock=true;this.hoverdiv.innerHTML='<img src="/main/show_latex?'+encodeImageSrc(a.latex,true)+'"/>';if(document.all){this.hoverdiv.style.top=(event.clientY-10)+"px";this.hoverdiv.style.left=(event.clientX+20)+"px"}else{if(!b){b=window.event}this.hoverdiv.style.top=(b.pageY-10)+"px";this.hoverdiv.style.left=(b.pageX+20)+"px"}this.hoverdiv.style.display="block";this.lock=false;a.onmouseout=Panel.hidehover}},hidehover:function(){if(!this.hlock){$$("hover").style.display="none"}},init:function(f,c){this.hoverdiv=$$(f);var d;if(c!==undefined){d=document.getElementById(c)}else{d=document}var a=d.getElementsByTagName("area");for(i=0;i<a.length;i++){a[i].onmouseover=function(g){Panel.hover(this,g)};latex=a[i].alt;a[i].latex=latex;a[i].alt="";if(a[i].title==""){a[i].title=latex}if(a[i].onclick==undefined){a[i].onclick=function(){EqEditor.insert(this.latex)}}}if(d.getElementsByClassName==undefined){d.getElementsByClassName=function(l){var k=new RegExp("(?:^|\\s)"+l+"(?:$|\\s)");var o=d.getElementsByTagName("*");var j=[];var h;for(var g=0;(h=o[g])!=null;g++){var p=h.className;if(p&&p.indexOf(l)!=-1&&k.test(p)){j.push(h)}}return j}}var b=d.getElementsByClassName("panel");for(i=0;i<b.length;i++){if(b[i].id!=""){b[i].onmouseover=function(g){Panel.open(this)};b[i].onmouseout=function(g){Panel.close(this)}}}}};function EqTextArea(d,b,f,a,c){this.changed=false;this.orgtxt="";this.bArray_id=new Array();this.bArray_area=new Array();this.bArray_mode=new Array();this.bsize=0;this.updateExportArea=function(){for(i=0;i<this.bsize;i++){var h=this.exportEquation(this.bArray_mode[i]);var g=this.bArray_area[i].attributes;if(this.bArray_area[i].src!==undefined){this.bArray_area[i].src=h}else{if(this.bArray_area[i].value!==undefined){this.bArray_area[i].value=h}else{if(this.bArray_area[i].innerHTML!==undefined){this.bArray_area[i].innerHTML=h}}}}};this.addExportArea=function(j,h){var g=$$(j);if(g){this.bArray_id[this.bsize]=j;this.bArray_area[this.bsize]=g;this.bArray_mode[this.bsize]=h;this.bsize++}};this.changeExportArea=function(h,g){for(i=0;i<this.bsize;i++){if(h==this.bArray_id[i]){this.bArray_mode[i]=g;i=this.bsize}}};this.myUndo=0;this.myRedo=0;this.store_text=new Array();this.store_text.push("");this.addEvent=function(h,g){if(this.equation_input.addEventListener){this.equation_input.addEventListener(h,g,false)}else{this.equation_input.attachEvent("on"+h,g)}};this.set=function(k,h,l,g,j){if(k==undefined||k==""){k="equationview"}if(h==undefined||h==""){h="latex_formula"}if(l==undefined||l==""){l="equationcomment"}if(g==undefined||g==""){g="download"}if(j==undefined||j==""){j="intro"}this.equation_preview=$$(k);this.equation_input=$$(h);this.equation_comment=$$(l);this.equation_download=$$(g);this.intro_text=j;if(this.equation_input){this.addEvent("keydown",function(o){Panel.close();EqEditor.countclick();EqEditor.tabHandler(o)});this.addEvent("keyup",function(){EqEditor.textchanged();EqEditor.autorenderEqn(10)});this.addEvent("keypress",function(o){EqEditor.keyHandler(o)});if($$(this.intro_text)){$$(this.intro_text).onclick=function(o){EqEditor.targetArea.equation_input.focus();Opacity.fadeout(this.intro_text)}}}};this.cleartext=function(){this.equation_input.value="";this.equation_input.focus();this.changed=false;this.equation_preview.src=EDITOR_SRC+"/images/spacer.gif";Opacity.fadein(this.intro_text)};this.textchanged=function(){var g=this.getEquationStr();if(g.length==0){Opacity.fadein(this.intro_text)}else{Opacity.fadeout(this.intro_text)}if(g!=this.orgtxt){this.orgtxt=g;this.changed=true;return true}return false};this.auton=0;this.renderCountdown=function(){if(this.auton>0){this.auton--;var g=new Function(this.renderCountdown());setTimeout(g,100)}else{this.renderEqn(null)}};this.autorenderEqn=function(g){if(this.auton>0&&g>0){this.auton=g}else{this.auton=g;this.renderCountdown()}};this.insertText=function(r,v,l){var q="";if(v==1000){v=r.length-1}if(v==null){v=r.indexOf("{")+1;if(v<=0){r+=" ";v=r.length}else{if(r.charAt(v)!="}"){v=r.indexOf("}",v)+1}}}var w=(l==null)?v:l;var p;var x=this.equation_input;var o=(r.substring(1,5)=="left");if(document.selection){x.focus();var j=document.selection.createRange();p=this.equation_input.value.length+1;var g=j.duplicate();while(g.parentElement()==x&&g.move("character",1)==1){--p}if((o||w>=0)&&j.text.length){if(o){ins_point=7}else{ins_point=w}if(w==null){v=r.length+j.text.length+1}else{if(w<v){v+=j.text.length}}j.text=r.substring(0,ins_point)+j.text+r.substr(ins_point)}else{j.text=r}var t=x.createTextRange();t.collapse(true);v=p+v;v-=x.value.substr(0,v).split("\n").length-1;t.moveEnd("character",v);t.moveStart("character",v);t.select()}else{if(x.selectionStart||x.selectionStart=="0"){var u=x.selectionStart;var h=x.selectionEnd;var k=u+r.length;if((o||w>=0)&&h>u){if(o){ins_point=7}else{ins_point=w}if(w==null){v=r.length+h-u+1}else{if(w<v){v+=h-u}}r=r.substring(0,ins_point)+x.value.substring(u,h)+r.substr(ins_point)}x.value=x.value.substring(0,u)+r+x.value.substring(h,x.value.length);x.selectionStart=k;x.selectionEnd=k;x.focus();x.setSelectionRange(u+v,u+v)}else{x.value+=r}}this.textchanged();this.autorenderEqn(10);Panel.close(null);x.focus()};this.getEquationStr=function(){var g=this.equation_input.value;g=g.replace(/^\s+|\s+$/g,"");g=g.replace(/\s+/g," ");if(g.length>0){return EqEditor.getSize()+EqEditor.getCompressed()+EqEditor.getDPI()+EqEditor.getBG()+EqEditor.getFont()+g}return""};this.exportMessage=function(h){var g=$$("exportmessage");if(g){g.innerHTML=h}};this.exportEquation=function(g){var h=EqEditor.getFormat();switch(g){case"wp":this.exportMessage("Wordpress markup for this equation is:");text=EqEditor.getSize()+this.equation_input.value;return EqEditor.get_inline_wrap(text,"[latex]{$TEXT}[/latex]\n","$latex {$TEXT}$ ");break;case"phpBB":this.exportMessage("PHP Bulletin Board markup for this equation is:");text=this.getEquationStr();return("[tex]"+text+"[/tex]\n");break;case"tw":this.exportMessage("TiddlyWiki markup for this equation is:");text=this.getEquationStr();text=text.replace(/\[/g,"%5B");text=text.replace(/\]/g,"%5D");return("[img["+EQUATION_ENGINE+"/"+h+".latex?"+text+"]]");break;case"url":this.exportMessage("The URL link to this equation is:");text=this.getEquationStr();text=text.replace(/\s/g,"&space;");text=text.replace(/\+/g,"&plus;");return(EQUATION_ENGINE+"/"+h+".latex?"+text);break;case"urlencoded":this.exportMessage("The Encoded URL link to this equation is:");text=escape(this.getEquationStr());text=text.replace(/\+/g,"&plus;");return(EQUATION_ENGINE+"/"+h+".latex?"+text);break;case"pre":this.exportMessage("HTML code using pre-tags is:");text=EqEditor.getSize()+this.equation_input.value;return EqEditor.get_inline_wrap(text,'<pre xml:lang="latex">{$TEXT}</pre>\n','<code xml:lang="latex">{$TEXT}</code> ');break;case"doxygen":this.exportMessage("DOxygen markup for this equation is:");text=EqEditor.getSize()+this.equation_input.value;return EqEditor.get_inline_wrap(text,"\\f[{$TEXT}\\f]\n","\\f${$TEXT}\\f$ ");break;case"htmledit":this.exportMessage("HTML code to embed this equation into a web page is:");text=this.getEquationStr();if(h=="swf"){return('<a href="http://www.codecogs.com/eqnedit.php?latex='+text.replace(/\+/g,"@plus;")+'" target="_blank">'+AC_FL_RunContent("codebase","http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0","width","600","height","100","src",(EQUATION_ENGINE+"/swf.latex?"+text),"quality","high","pluginspage","http://www.macromedia.com/go/getflashplayer","align","top","scale","showall","wmode","window","devicefont","false","bgcolor","#ffffff","menu","true","allowFullScreen","true","movie",(EQUATION_ENGINE+"/swf.latex?"+text))+"</a>")}else{return('<a href="http://www.codecogs.com/eqnedit.php?latex='+text.replace(/\+/g,"@plus;")+'" target="_blank"><img src="'+EQUATION_ENGINE+"/"+h+".latex?"+text+'" title="'+text+'" /></a>')}break;case"html":this.exportMessage("HTML code to embed this equation into a web page is:");text=this.getEquationStr();if(h=="swf"){return AC_FL_RunContent("codebase","http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0","width","600","height","100","src",(EQUATION_ENGINE+"/swf.latex?"+text),"quality","high","pluginspage","http://www.macromedia.com/go/getflashplayer","align","top","scale","showall","wmode","window","devicefont","false","bgcolor","#ffffff","menu","true","allowFullScreen","true","movie",(EQUATION_ENGINE+"/swf.latex?"+text))}else{return('<img src="'+EQUATION_ENGINE+"/"+h+".latex?"+text+'" title="'+text+'" />')}break;default:this.exportMessage("LaTeX markup for this equation is:");text=EqEditor.getSize()+this.equation_input.value;return EqEditor.get_inline_wrap(text,"\\[{$TEXT}\\]\n","${$TEXT}$ ");break}return text};this.setdownload=function(g){if(this.equation_download){this.equation_download.innerHTML=g}};this.setcomment=function(g){if(this.equation_comment){this.equation_comment.innerHTML=g}};this.renderEqn=function(p){var l=this.equation_input.value;l=l.replace(/^\s+|\s+$/g,"");if(l.length==0){return true}var k=0;var h;for(h=0;h<l.length;h++){switch(l.charAt(h)){case"{":if(h==0||l[h-1]!="\\"){k++}break;case"}":if(h==0||l[h-1]!="\\"){k--}break}}var o;if(k==0){if($$("renderbutton")){$$("renderbutton").className="greybutton"}var g=this.equation_preview;l=this.getEquationStr();sval=l.replace(/"/g,'\\"').replace(/\s/g,"&space;");var j=EqEditor.getFormat();if(this.changed){this.setcomment("");switch(j){case"gif":case"png":case"svg":g.src=EQUATION_ENGINE+"/"+j+".latex?"+l;this.setdownload('<a href="'+EQUATION_ENGINE+"/"+j+".download?"+sval+'">Click here to Download Image ('+j.toUpperCase()+")</a>");break;case"pdf":g.src=EQUATION_ENGINE+"/gif.latex?"+l;this.setdownload('<a target="_blank" href="'+EQUATION_ENGINE+"/pdf.download?"+sval+'"><img src="images/pdf.jpg" width="30" height="30" align="middle" />Click here to Download Equation (PDF)</a>');break}this.updateExportArea()}}else{if(k<0){this.setcomment("<br/><span class=\"orange\">You have more <strong>closed '}' brackets</strong> than open '{' brackets</span>")}else{this.setcomment("<br/><span class=\"orange\">You have more <strong>open '{' brackets</strong> than closed '}' brackets</span>")}}this.changed=false};this.clickval=0;this.countclick=function(){var g=this.equation_input.value;this.clickval++;if(this.clickval>=3){this.clickval=0;if(this.myUndo==0||this.store_text[this.myUndo]!=g){if(this.myUndo>20){this.store_text.shift()}else{this.myUndo++}this.store_text[this.myUndo]=g}}this.myRedo=0};this.undo=function(h){if(this.myRedo==0){if(this.myUndo>20){this.store_text.shift()}else{this.myUndo++}this.store_text[this.myUndo]=this.equation_input.value}if(this.myRedo<this.myUndo){this.myRedo++;if(this.myRedo==this.myUndo&&$$("undobutton")){$$("undobutton").src=EDITOR_SRC+"/images/buttons/undo-x.gif"}var g=$$("redobutton");if(g){g.src=EDITOR_SRC+"/images/buttons/redo.gif"}}else{return}z=this.store_text.length-this.myRedo-1;if(this.store_text[z]){this.equation_input.value=this.store_text[z]}else{this.equation_input.value=this.store_text[0]}this.equation_input.focus()};this.redo=function(h){if(this.myRedo>0){this.myRedo--;if(this.myRedo==0&&$$("redobutton")){$$("redobutton").src=EDITOR_SRC+"/images/buttons/redo-x.gif"}var g=$$("undobutton");if(g){g.src=EDITOR_SRC+"/images/buttons/undo.gif"}}else{return}var j=this.store_text.length-this.myRedo-1;if(this.store_text[j]){this.equation_input.value=this.store_text[j]}else{this.equation_input.value=this.store_text[0]}this.equation_input.focus()};this.Export=function(g,h){g(this.exportEquation(h));Example.add_history(this.equation_input.value);Example.hide()};this.load=function(o){var l=o;if(l!==undefined){l=unescape(l);l=l.replace(/@plus;/g,"+");l=l.replace(/&plus;/g,"+");l=l.replace(/&space;/g," ");var h,g,k;do{k=0;l=l.replace(new RegExp("^[\\s]+","g"),"");h=l.indexOf(" ");var j=l.indexOf("}");if(j!=-1&&(j<h||h==-1)){h=j}if(h!=-1){g=l.substr(0,h);if(EqEditor.setSelIndx("fontsize",g)){k=1}if(g=="\\inline"){$$("inline").checked=true;$$("compressed").checked=true;k=1}if(g.substr(0,4)=="\\bg_"&&EqEditor.setSelIndx("bg",g.substr(4))){k=1}if(g.substr(0,4)=="\\fn_"&&EqEditor.setSelIndx("font",g.substr(4))){k=1}if(g.substr(0,5)=="\\dpi{"&&EqEditor.setSelIndx("dpi",g.substr(5))){k=1}if(k){l=l.substr(h+1)}}}while(k);if(l.length>0){this.equation_input.value=l;this.textchanged();this.renderEqn(null);Opacity.fadeout(this.intro_text)}}};if(d!==undefined){this.set(d,b,f,a,c)}}var gallery=null;var Example={lastbutton:null,load_json:function(f,h){var a=$$("load_json");if(a!=null){a.parentNode.removeChild(a);delete a}var g=new Date();h="rand="+g.getTime()+"&"+h;var c=document.getElementsByTagName("head")[0];var b=document.createElement("script");b.src=FAVORITE_ENGINE+"/"+f+"?"+h;b.id="load_json";c.appendChild(b)},add_fav:function(){text=EqEditor.getEquation();if(text!=""){this.load_json("favorite_json.php","sid="+EqEditor.SID+"&add&eqn="+escape(text.replace(/\+/g,"@plus;")));setTimeout("Example.show(null, 'fav')",200)}},del_fav:function(a){this.load_json("favorite_json.php","sid="+EqEditor.SID+"&delete="+a);setTimeout("Example.show(null, 'fav')",200)},add_history:function(a){if(a!=""){this.load_json("history_json.php","sid="+EqEditor.SID+"&add&eqn="+escape(a.replace(/\+/g,"@plus;")))}},show:function(a,b){$$("bar1").style.display="none";$$("bar2").style.display="none";if($$("photos")){$$("photos").innerHTML=""}if(a!==null){if(this.lastbutton!==null){this.lastbutton.className="lightbluebutton"}a.className="greybutton";this.lastbutton=a}gallery=new Scroll();if(b=="fav"||b=="history"){var c=new Date();gallery.init("photos","leftarrow","rightarrow","overview",FAVORITE_ENGINE+"/example_json.php?fn=gallery&rand="+c.getTime()+"&sid="+EqEditor.SID)}else{gallery.init("photos","leftarrow","rightarrow","overview",FAVORITE_ENGINE+"/example_json.php?fn=gallery")}gallery.visible_num=1;gallery.new_offset=5;gallery.maxpanels=1;gallery.set_width(600,100,60);gallery.set_subtext("&type="+b);gallery.add_panel();gallery.setarrow();gallery.setoverview()},hide:function(){$$("bar2").style.display="none";$$("bar1").style.display="none";if(this.lastbutton!==null){this.lastbutton.className="lightbluebutton"}this.lastbutton=null}};var ExportButton={bArray_id:new Array(),bArray_area:new Array(),bArray_mode:new Array(),bArray_fn:new Array(),bsize:0,state:function(a){for(i=0;i<this.bsize;i++){if(a){this.bArray_id[i].className="lightbluebutton"}else{this.bArray_id[i].className="greybutton"}}},add:function(c,d,g,f){var b=$$(d);if(b){this.bArray_id[this.bsize]=b;this.bArray_area[this.bsize]=c;this.bArray_mode[this.bsize]=f;this.bArray_fn[this.bsize]=g;b.onclick=function(h){var a=this.exportid;ExportButton.bArray_area[a].Export(ExportButton.bArray_fn[a],ExportButton.bArray_mode[a])};b.exportid=this.bsize;this.bsize++}}};var EqEditor={SID:0,copy_button:null,key_text:"",format:"gif",setSelIndx:function(d,a){var c=$$(d);if(c&&a){for(var b=0;b<c.options.length;b++){if(c.options[b].value==a){c.options[b].selected=true;return true}}}return false},targetArray:new Array(),targetSize:0,targetArea:null,curTarget:0,changeExportArea:function(b,a){for(i=0;i<this.targetSize;i++){this.targetArray[i].changeExportArea(b,a)}},autorenderEqn:function(a){this.targetArea.autorenderEqn(a)},change:function(a){if(a!=this.curTarget){this.curTarget=a;this.key_rext=""}this.targetArea=this.targetArray[a]},add:function(b,a){this.targetArray[this.targetSize]=b;b.equation_input.onfocus=new Function("EqEditor.change("+this.targetSize+");");if(a){if(window.addEventListener){window.addEventListener("resize",new Function("EqEditor.resize("+this.targetSize+");"),false)}else{window.attachEvent("onresize",new Function("EqEditor.resize("+this.targetSize+");"))}EqEditor.resize(this.targetSize)}if(this.targetSize==0){b.equation_input.focus()}this.targetSize++},editor_id:null,embed:function(f,c,b,d){this.editor_id=f;var a="http://latex.codecogs.com/editor_embedded_json.php?id="+f+"&SID="+c+"&design="+b;if(d!=undefined&&d!=""){a+="&lang="+d}document.write('<script src="'+a+'" type="text/javascript"><\/script>')},moveto:function(c){if(c!=this.editor_id){var a=$$(c);while($$(this.editor_id).childNodes[0]){var b=$$(this.editor_id).childNodes[0];b.parentNode.removeChild(b);a.appendChild(b)}this.editor_id=c}},targetFn:null,copyToTarget:function(a){if(this.targetFn!==null){this.targetFn(a)}},init:function(g,c,b,a){Panel.init("hover",a);if(g==""){this.SID=Cookie.get("eqeditor");if(!this.SID){var f=new Date();this.SID=f.getTime();Cookie.set("eqeditor",g,1000)}}else{this.SID=g}if(c!==undefined){this.add(c,b);this.targetArea=c}this.setSelIndx("format",Cookie.get("format"));this.setSelIndx("font",Cookie.get("font"));this.setSelIndx("fontsize",Cookie.get("fontsize"));this.setSelIndx("dpi",Cookie.get("dpi"));this.setSelIndx("bg",Cookie.get("bg"));$onclick("undobutton",function(d){EqEditor.targetArea.undo()});$onclick("redobutton",function(d){EqEditor.targetArea.redo()});$onchange("bg",function(h){var d=$$("bg");if(d){Cookie.set("bg",d.value,10)}EqEditor.update()});$onchange("dpi",function(h){var j=$$("dpi");if(j){Cookie.set("dpi",j.value,10)}EqEditor.update()});$onchange("font",function(h){var d=$$("font");if(d){Cookie.set("font",d.value,10)}EqEditor.update()});$onchange("format",function(h){var d=false;EqEditor.setFormat(EqEditor.getFormat())});$onchange("fontsize",function(){var d=$$("fontsize");if(d){Cookie.set("fontsize",d.value,10)}EqEditor.update()});$onclick("inline",function(h){var d=$$("compressed");if(d){d.checked=this.checked}EqEditor.update()});$onclick("compressed",function(d){EqEditor.update()})},textchanged:function(){if(this.targetArea.textchanged()){ExportButton.state(true)}},update:function(){this.targetArea.textchanged();this.targetArea.renderEqn(null)},load:function(a){if(this.targetArea!=null){this.targetArea.load(a)}},insert:function(a,c,b){if(this.targetArea!=null){this.targetArea.insertText(a,c,b);ExportButton.state(true)}},cleartext:function(){this.targetArea.cleartext();ExportButton.state(false)},setFormat:function(c){EqEditor.format=c;switch(c){case"gif":action=false;break;case"png":action=false;break;case"pdf":action=true;break;case"swf":action=true;break;case"emf":action=true;break}Cookie.set("format",c,10);var b=$$("dpi");if(b){b.disabled=action;b.readonly=action}b=$$("bg");if(b){b.disabled=action;b.readonly=action}EqEditor.targetArea.changed=true;EqEditor.targetArea.renderEqn(null)},getEquation:function(){if(this.targetArea!=null){return this.targetArea.getEquationStr()}},getFormat:function(){var b=$$("format");if(b){return b.value}return EqEditor.format},getFont:function(){var b=$$("font");if(b&&b.value!=""){return"\\fn_"+b.value+" "}return""},getSize:function(){var b=$$("fontsize");if(b&&b.value!=""){return b.value+" "}return""},getDPI:function(){var b=$$("dpi");if(b&&b.value!="110"){return"\\dpi{"+b.value+"} "}return""},getBG:function(){var d=$$("bg");if(d){var c=d.value.toLowerCase();if(c!="transparent"){return"\\bg_"+c+" "}}return""},getCompressed:function(){var b=$$("compressed");if(b&&b.checked){return"\\inline "}return""},get_inline_wrap:function(h,f,g){var d=$$("inline");if(d){var c=$$("compressed");if(d.checked){if(!c.checked){h="\\displaystyle "+h}return g.replace("{$TEXT}",h)}else{if(c.checked){h="\\inline "+h}return f.replace("{$TEXT}",h)}}return f.replace("{$TEXT}",h)},extendchar:null,countclick:function(){this.targetArea.countclick();var b=$$("redobutton");if(b){b.src=EDITOR_SRC+"/images/buttons/redo-x.gif"}b=$$("undobutton");if(b){b.src=EDITOR_SRC+"/images/buttons/undo.gif"}},tabHandler:function(h){var g=9;var k=this.targetArea.equation_input;if(h.keyCode==g){if(document.selection){var f=document.selection.createRange();i=k.value.length+1;var d=f.duplicate();while(d.parentElement()==k&&d.move("character",1)==1){--i}startPos=i;if(startPos==k.value.length){return true}}else{startPos=k.selectionStart;if(startPos==k.value.length){return true}}var p=k.value.indexOf("{",startPos);if(p==-1){p=k.value.length}else{p++}var o=k.value.indexOf("&",startPos);if(o==-1){o=k.value.length}else{o++}var j=k.value.indexOf("\\\\",startPos);if(j==-1){j=k.value.length}else{j+=2}var l=Math.min(Math.min(p,o),j);if(document.selection){range=k.createTextRange();range.collapse(true);l-=k.value.substr(0,l).split("\n").length-1;range.moveEnd("character",l);range.moveStart("character",l);range.select()}else{k.setSelectionRange(l,l)}if(h.preventDefault){h.preventDefault()}else{h.returnValue=false}return false}},backCursor:function(a){if(document.selection){a.focus();sel=document.selection.createRange();if(sel.text.length>0){sel.text=""}else{sel.moveEnd("character",1);sel.text=""}sel.select()}else{if(a.selectionStart||a.selectionStart=="0"){s=a.selectionStart;e=a.selectionEnd;a.value=a.value.substring(0,s)+a.value.substring(e+1,a.value.length);a.selectionStart=s;a.selectionEnd=s;a.focus()}}},extendkey:function(a){switch(this.key_text){case"\\left":this.insert(" \\right "+a,0);break;case"\\frac":case"\\tfrac":if(a=="}"){this.insert("}{}",0)}break;case"\\begin":if(a=="}"){this.insert("} \\end{}",0)}break;default:this.insert(a,0)}this.extendchar=a},keyHandler:function(c){var a;if(window.event){a=window.event.keyCode}else{if(c){a=c.which}}var b=String.fromCharCode(a);if(b==this.extendchar){this.backCursor(this.equation_input)}this.extendchar=null;switch(b){case"{":this.extendkey("}");break;case"[":this.extendkey("]");break;case"(":this.extendkey(")");break;case'"':this.extendkey('"');break}if(b!=" "){if(b=="\\"){this.key_text="\\"}else{if(!b.match(/^[a-zA-Z]$/)){this.key_text=""}else{this.key_text+=b}}}},addText:function(c,b,a){var g=c.getElementById(b);if(c.selection){g.focus();sel=c.selection.createRange();sel.text=a}else{var h=g.scrollTop;if(g.selectionStart||g.selectionStart=="0"){var f=g.selectionStart;var d=g.selectionEnd;var j=f+a.length;g.value=g.value.substring(0,f)+a+g.value.substring(d,g.value.length);pos=a.length+d-f;g.selectionStart=j;g.selectionEnd=j;g.focus();g.setSelectionRange(f+pos,f+pos)}else{g.value+=a}g.scrollTop=h}},makeEquationsMatrix:function(a,c,b){if(c===undefined){c=false}if(b===undefined){c=false}eqns="\\begin{"+a+((c)?"":"*")+"}";eqi="\n &"+((c)?" ":"= ")+((b)?"\\text{ if } x= ":"");eqEnd="\n\\end{"+a+((c)?"":"*")+"}";i=0;dim=prompt("Enter the number of lines:","");if(dim!=""&&dim!==null){n=parseInt(dim);if(!isNaN(n)){for(i=1;i<=n-1;i++){eqns=eqns+(eqi+"\\\\ ")}eqns=(eqns+eqi)+eqEnd;this.insert(eqns,a.length+((c)?0:1)+9)}}},makeArrayMatrix:function(d,j,a){var f=j+"\\begin{"+d+"matrix}";var h="\n";var c="\n\\end{"+d+"matrix}"+a;var b=0;var g=prompt('Enter the array dimensions separated by a comma (e.g. "2,3" for 2 rows and 3 columns):',"");if(g!==""&&g!==null){g=g.split(",");m=parseInt(g[0]);n=parseInt(g[1]);if(!isNaN(m)&&!isNaN(n)){for(b=2;b<=n;b++){h=h+" & "}for(b=1;b<=m-1;b++){f=f+h+"\\\\ "}f=f+h+c;this.insert(f,d.length+j.length+15)}}},resize:function(b){var a,c;if(self.innerHeight){c=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){c=document.documentElement.clientHeight}else{if(document.body){c=document.body.clientHeight}}}this.targetArray[b].equation_input.style.height=parseInt(Math.max((c-200)/3,40))+"px"}};var oDiv=document.createElement("div");var oImg=document.createElement("img");var Scroll=function(){};Scroll.prototype={init:function(d,a,c,g,b){this.panels=0;this.maxpanels=0;this.speed=10;this.pause=2;this.visible=0;this.visible_num=2;this.layers=new Array();this.layers_offset=new Array();this.new_offset=0;this.subtext="";this.vertical=false;this.left_arrow=document.getElementById(a);this.right_arrow=document.getElementById(c);this.maindiv=document.getElementById(d);if(g!==""){this.overview=document.getElementById(g)}else{this.overview=null}if(b.indexOf("_json")>-1){this.ajax_php=null;this.json_php=b;this.ajax_response_fn=null}else{this.ajax_php=b;this.json_php=null;var f=this;this.ajax_response_fn=function(){f.add_panel_response()}}},set_subtext:function(a){this.subtext=a},set_width:function(b,a,c){this.width=b;this.height=a;this.speed=c;if(this.vertical){this.step=this.step_total=this.height/this.speed}else{this.step=this.step_total=this.width/this.speed}},add:function(a){var b=this.new_offset;if(this.vertical){this.new_offset+=this.height}else{this.new_offset+=this.width}this.layers[this.panels]=a;this.layers_offset[this.panels]=b;this.panels++;if(this.panels>this.maxpanels){this.maxpanels=this.panels}a.style.position="absolute";if(this.vertical){a.style.top=b+"px"}else{a.style.left=b+"px"}},add_id:function(b){var a=document.getElementById(b);if(a){this.add(a)}},add_panel_div:function(a){this.add(a);this.maindiv.appendChild(a);if(this.visible+this.visible_num>=this.panels){this.add_panel()}},add_panel_response:function(){if(req.readyState==4){if(req.status==200&&req.responseText.length>0){var a=oDiv.cloneNode(false);a.innerHTML=req.responseText;this.add_panel_div(a)}this.setarrow();this.setoverview()}},add_panel_json:function(b){if(b.length>0){var a=oDiv.cloneNode(false);a.innerHTML=b;this.add_panel_div(a)}this.setarrow();this.setoverview()},add_panel:function(){if(this.ajax_php&&this.ajax_response_fn){if(this.ajax_php.indexOf("?")==-1){loadXMLDoc(this.ajax_php+"?panel="+this.panels+this.subtext,this.ajax_response_fn)}else{loadXMLDoc(this.ajax_php+"&panel="+this.panels+this.subtext,this.ajax_response_fn)}}else{if(this.json_php){var b=this.panels;var d=document.getElementsByTagName("head")[0];var c=document.createElement("script");if(this.json_php.indexOf("?")==-1){c.src=this.json_php+"?panel="+b+this.subtext}else{c.src=this.json_php+"&panel="+b+this.subtext}d.appendChild(c)}}},redraw:function(){if(this.json_php||(this.ajax_php&&this.ajax_response_fn)){this.panels=0;this.visible=0;this.new_offset=0;while(this.maindiv.firstChild){this.maindiv.removeChild(this.maindiv.firstChild)}}if(this.ajax_php&&this.ajax_response_fn){var f=this;if(this.ajax_php.indexOf("?")==-1){loadXMLDoc(f.ajax_php+"?panel="+this.panels+this.subtext,f.ajax_response_fn)}else{loadXMLDoc(f.ajax_php+"&panel="+this.panels+this.subtext,f.ajax_response_fn)}}else{if(this.json_php){var b=this.panels;var d=document.getElementsByTagName("head")[0];var c=document.createElement("script");if(this.json_php.indexOf("?")==-1){c.src=this.json_php+"?panel="+b+this.subtext}else{c.src=this.json_php+"&panel="+b+this.subtext}d.appendChild(c)}}},move:function(a){this.new_offset+=a;for(var c=0;c<this.panels;c++){this.layers_offset[c]+=a;if(this.vertical){this.layers[c].style.top=this.layers_offset[c]+"px"}else{this.layers[c].style.left=this.layers_offset[c]+"px"}}this.step++;if(this.step<this.step_total){var b=this;window.setTimeout(function(){b.move(a)},this.pause)}},setoverview:function(){if(this.overview!==null){this.overview.innerHTML="";var a="";var b=this;for(i=0;i<this.maxpanels;i++){newimg=oImg.cloneNode(false);newimg.className="overview";if(i>=this.visible&&i<(this.visible+this.visible_num)){newimg.src="http://www.codecogs.com/images/scroll/soliddot.gif"}else{newimg.src="http://www.codecogs.com/images/scroll/emptydot.gif";newimg.i=i;newimg.onclick=function(){b.jump(this)}}this.overview.appendChild(newimg)}}},setarrow:function(){this.left_arrow.src="http://www.codecogs.com/images/scroll/"+(this.visible<=0?"leftarrow_grey.gif":"leftarrow.gif");this.right_arrow.src="http://www.codecogs.com/images/scroll/"+(this.visible>=(this.panels-1)?"rightarrow_grey.gif":"rightarrow.gif")},jump:function(a){if(this.step==this.step_total){panel=a.i;var b=panel-this.visible;this.step=this.step_total-Math.abs(b)*this.step_total;if(this.visible>panel){this.move(this.speed)}else{this.move(-this.speed)}this.visible+=b;if(this.visible+this.visible_num>=this.panels){this.add_panel()}else{this.setarrow();this.setoverview()}}},left:function(){if(this.step==this.step_total){if(this.visible<(this.panels-1)){this.visible++;this.step=0;this.move(-this.speed);if(this.visible+this.visible_num>=this.panels){this.add_panel()}else{this.setarrow();this.setoverview()}}}},right:function(){if(this.step==this.step_total){if(this.visible>0){this.step=0;this.move(this.speed);this.visible--;this.setarrow();this.setoverview()}}},subsearch:function(a){if(a!==""){this.subtext=("&subtext="+a)}else{this.subtext=""}this.redraw()}};
